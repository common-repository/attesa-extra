!function(a){"use strict";a(document).ready(function(){t.init()});var t={importData:{},allowPopupClosing:!0,init:function(){var t=this;this.categoriesFilter(),a(".awp-search-input").on("keyup",function(){0<a(this).val().length?(a(".awp-demo-wrap .themes").find(".theme-wrap").hide(),a(".awp-demo-wrap .themes").find('.theme-wrap[data-name*="'+a(this).val().toLowerCase()+'"]').show()):a(".awp-demo-wrap .themes").find(".theme-wrap").show()}),a(".awp-demo-wrap .theme-actions a.button").on("click",function(a){a.stopPropagation()}),a(".awp-open-popup").click(function(e){e.preventDefault();var n=a(this).data("demo-id"),i=a(".preview-"+n),o=a(".preview-all-"+n);i.show(),o.show(),t.getDemoData(n)}),a(document).on("click",".install-now",this.installNow),a(document).on("click",".activate-now",this.activatePlugins),a(document).on("wp-plugin-install-success",this.installSuccess),a(document).on("wp-plugin-installing",this.pluginInstalling),a(document).on("wp-plugin-install-error",this.installError)},categoriesFilter:function(){var t=a(".awp-demo-wrap .themes").find(".theme-wrap"),e="awp-is-fadeout",n=function(){var n=a.Deferred();return t.addClass(e),setTimeout(function(){t.removeClass(e).hide(),n.resolve()},200),n.promise()},i=function(a,e){var n=a?'[data-categories*="'+a+'"]':"div";"all"===a&&(n="div"),t.filter(n).show().addClass("awp-is-fadein"),setTimeout(function(){t.removeClass("awp-is-fadein"),e.resolve()},200)},o=function(t){var e=a.Deferred();return n().done(function(){i(t,e)}),e};a(".awp-navigation-link").on("click",function(t){t.preventDefault(),a(this).parent().siblings().removeClass("active"),a(this).parent().addClass("active");var e=this.hash.slice(1),n=a(".awp-demo-wrap .themes");n.css("min-width",n.outerHeight()),o(e).done(function(){n.removeAttr("style")})})},getDemoData:function(t){var e=this;a.ajax({url:awpDemos.ajaxurl,type:"get",data:{action:"awp_ajax_get_import_data",demo_name:t,security:awpDemos.awp_import_data_nonce},complete:function(t){e.importData=a.parseJSON(t.responseText)}}),a.ajax({url:awpDemos.ajaxurl,type:"get",data:{action:"awp_ajax_get_demo_data",demo_name:t,demo_data_nonce:awpDemos.demo_data_nonce},complete:function(n){e.runPopup(n);var i=a(".preview-"+t),o=a(".preview-all-"+t);i.hide(),o.hide()}})},runPopup:function(t){var e=this,n=a("html").innerWidth();a("html").css("overflow","hidden");var i=a("html").innerWidth();a("html").css("margin-right",i-n),a("#awp-demo-popup-wrap").fadeIn(),a(t.responseText).appendTo(a("#awp-demo-popup-content")),a(".awp-demo-popup-close, .awp-demo-popup-overlay").on("click",function(a){a.preventDefault(),!0===e.allowPopupClosing&&e.closePopup()}),a(".awp-plugins-next").on("click",function(t){t.preventDefault(),a("#awp-demo-plugins").hide(),a("#awp-demo-import-form").show()}),a("#awp-demo-import-form").submit(function(t){t.preventDefault();var n=a(this).find('[name="awp_import_demo"]').val(),i=a(this).find('[name="awp_import_demo_data_nonce"]').val(),o=[];a(this).find('input[type="checkbox"]').each(function(){!0===a(this).is(":checked")&&o.push(a(this).attr("name"))}),a(this).hide(),a(".awp-loader").show(),e.importContent({demo:n,nonce:i,contentToImport:o,isXML:a("#awp_import_xml").is(":checked")})})},importContent:function(t){var e,n,i=this,o=(Date.now(),{awp_import_demo:t.demo,awp_import_demo_data_nonce:t.nonce});if(this.allowPopupClosing=!1,a(".awp-demo-popup-close").fadeOut(),0===t.contentToImport.length){setTimeout(function(){a(".awp-loader").hide(),a(".awp-last").show()},1e3),a.ajax({url:awpDemos.ajaxurl,type:"post",data:{action:"awp_after_import",awp_import_demo:t.demo,awp_import_demo_data_nonce:t.nonce,awp_import_is_xml:t.isXML},complete:function(a){}}),this.allowPopupClosing=!0,a(".awp-demo-popup-close").fadeIn();return}for(var s in this.importData){var p=a.inArray(this.importData[s].input_name,t.contentToImport);if(-1!==p){e=s,t.contentToImport.splice(p,1),o.action=this.importData[s].action;break}}a(".awp-import-status").append('<p class="awp-importing">'+this.importData[e].loader+"</p>");var l=a.ajax({url:awpDemos.ajaxurl,type:"post",data:o,complete:function(e){clearTimeout(n);var o=!0;if(500===e.status||502===e.status||503===e.status)a(".awp-importing").addClass("awp-importing-failed").removeClass("awp-importing").text(awpDemos.content_importing_error+" "+e.status);else if(-1!==e.responseText.indexOf("successful import"))a(".awp-importing").addClass("awp-imported").removeClass("awp-importing");else{var s=a.parseJSON(e.responseText),p="";for(var l in s)p+=s[l],"xml_import_error"===l&&(o=!1);a(".awp-importing").addClass("awp-importing-failed").removeClass("awp-importing").text(p),i.allowPopupClosing=!0,a(".awp-demo-popup-close").fadeIn()}!0===o&&i.importContent(t)}});n=setTimeout(function(){l.abort(),i.allowPopupClosing=!0,a(".awp-demo-popup-close").fadeIn(),a(".awp-importing").addClass("awp-importing-failed").removeClass("awp-importing").text(awpDemos.content_importing_error)},9e5)},closePopup:function(){a("html").css({overflow:"","margin-right":""}),a(".preview-icon").hide(),a(".preview-all").hide(),a("#awp-demo-popup-wrap").fadeOut(),setTimeout(function(){a("#awp-demo-popup-content").html("")},600)},installNow:function(t){t.preventDefault();var e=a(t.target),n=a(document);!(e.hasClass("updating-message")||e.hasClass("button-disabled"))&&(wp.updates.shouldRequestFilesystemCredentials&&!wp.updates.ajaxLocked&&(wp.updates.requestFilesystemCredentials(t),n.on("credential-modal-cancel",function(){a(".install-now.updating-message").removeClass("updating-message").text(wp.updates.l10n.installNow),wp.a11y.speak(wp.updates.l10n.updateCancel,"polite")})),wp.updates.installPlugin({slug:e.data("slug")}))},activatePlugins:function(t){t.preventDefault();var e=a(t.target),n=e.data("init");e.data("slug"),!(e.hasClass("updating-message")||e.hasClass("button-disabled"))&&(e.addClass("updating-message button-primary").html(awpDemos.button_activating),a.ajax({url:awpDemos.ajaxurl,type:"POST",data:{action:"awp_ajax_required_plugins_activate",_wpnonce:awpDemos.demo_plugins_activate_nonce,init:n}}).done(function(a){a.success&&e.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(awpDemos.button_active)}))},installSuccess:function(t,e){t.preventDefault();var n=a(".awp-plugin-"+e.slug).find(".button"),i=n.data("init");n.removeClass("install-now installed button-disabled updated-message").addClass("updating-message").html(awpDemos.button_activating),setTimeout(function(){a.ajax({url:awpDemos.ajaxurl,type:"POST",data:{action:"awp_ajax_required_plugins_activate",_wpnonce:awpDemos.demo_plugins_activate_nonce,init:i}}).done(function(a){a.success?n.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(awpDemos.button_active):n.removeClass("updating-message")})},1200)},pluginInstalling:function(t,e){t.preventDefault(),a(".awp-plugin-"+e.slug).find(".button").addClass("updating-message")},installError:function(t,e){t.preventDefault(),a(".awp-plugin-"+e.slug).removeClass("button-primary").addClass("disabled").html(wp.updates.l10n.installFailedShort)}}}(jQuery);